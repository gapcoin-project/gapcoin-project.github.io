  {% include head.html %}
  <script src="https://d3js.org/d3.v5.js"></script>
  <script src="https://d3js.org/d3-color.v1.js"></script>
  <script src="https://d3js.org/d3-interpolate.v1.js"></script>
  <script src="https://d3js.org/d3-scale-chromatic.v1.js"></script>
<style>
.axis path,
.axis line { fill: none; stroke: #888; shape-rendering: crispEdges; }
.axis text { font-family: sans-serif; font-size: 11px; color:#888}
.loading {font-family: sans-serif; font-size: 15px;}
</style>
</head>
  <body class="global landing">
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->

    {% if site.pagebar %}
    {% include page-bar.html %}
    <div class="pusher">
    {% endif %}
      {% include landing-header.html %}
      {{ content }}
      {% include footer.html %}
    {% if site.pagebar %}
    </div>
    {% endif %}

    {% include js.html %}
    <script>

    var primedigitsdata = [];
    var gapsizedata = [];
    var primedigits = {
      81:13,82:14,82:15,82:16,83:17,83:18,83:19,84:20,84:21,84:22,
      84:23,85:24,85:25,85:26,86:27,86:28,86:29,87:30,87:31,87:32,
      87:33,88:34,88:35,88:36,89:37,89:38,89:39,90:40,90:41,90:42,
      91:43,91:44,91:45,91:46,92:47,92:48,92:49,93:50,93:51,93:52,
      94:53,94:54,94:55,94:56,95:57,95:58,95:59,96:60,96:61,96:62,
      97:63,97:64,97:65,97:66,98:67,98:68,98:69,99:70,99:71,99:72,
      100:73,100:74,100:75,100:76,101:77,101:78,101:79,102:80,
      102:81,102:82,103:83,103:84,103:85,103:86,104:87,104:88,
      104:89,105:90,105:91,105:92,106:93,106:94,106:95,106:96,
      107:97,107:98,107:99,108:100,108:101,108:102,109:103,109:104,
      109:105,109:106,110:107,110:108,110:109,111:110,111:111,111:112,
      112:113,112:114,112:115,112:116,113:117,113:118,113:119,114:120,
      114:121,114:122,115:123,115:124,115:125,115:126,116:127,116:128,
      116:129,117:130,117:131,117:132,118:133,118:134,118:135,119:136,
      119:137,119:138,119:139,120:140,120:141,120:142,121:143,121:144,
      121:145,122:146,122:147,122:148,122:149,123:150,123:151,123:152,
      124:153,124:154,124:155,125:156,125:157,125:158,125:159,126:160,
      126:161,126:162,127:163,127:164,127:165,128:166,128:167,128:168,
      128:169,129:170,129:171,129:172,130:173,130:174,130:175,131:176,
      131:177,131:178,131:179,132:180,132:181,132:182,133:183,133:184,
      133:185,134:186,134:187,134:188,134:189,135:190,135:191,135:192,
      136:193,136:194,136:195,137:196,137:197,137:198,137:199,138:200,
      138:201,138:202,139:203,139:204,139:205,140:206,140:207,140:208,
      140:209,141:210,141:211,141:212,142:213,142:214,142:215,143:216,
      143:217,143:218,143:219,144:220,144:221,144:222,145:223,145:224,
      145:225,146:226,146:227,146:228,146:229,147:230,147:231,147:232,
      148:233,148:234,148:235,149:236,149:237,149:238,150:239,150:240,
      150:241,150:242,151:243,151:244,151:245,152:246,152:247,152:248,
      153:249,153:250,153:251,153:252,154:253,154:254,154:255,155:256,
      155:257,155:258,156:259,156:260,156:261,156:262,157:263,157:264,
      157:265,158:266,158:267,158:268,159:269,159:270,159:271,159:272,
      160:273,160:274,160:275,161:276,161:277,161:278,162:279,162:280,
      162:281,162:282,163:283,163:284,163:285,164:286,164:287,164:288,
      165:289,165:290,165:291,165:292,166:293,166:294,166:295,167:296,
      167:297,167:298,168:299,168:300,168:301,168:302,169:303,169:304,
      169:305,170:306,170:307,170:308,171:309,171:310,171:311,171:312,
      172:313,172:314,172:315,173:316,173:317,173:318,174:319,174:320,
      174:321,174:322,175:323,175:324,175:325,176:326,176:327,176:328,
      177:329,177:330,177:331,178:332,178:333,178:334,178:335,179:336,
      179:337,179:338,180:339,180:340,180:341,181:342,181:343,181:344,
      181:345,182:346,182:347,182:348,183:349,183:350,183:351,184:352,
      184:353,184:354,184:355,185:356,185:357,185:358,186:359,186:360,
      186:361,187:362,187:363,187:364,187:365,188:366,188:367,188:368,
      189:369,189:370,189:371,190:372,190:373,190:374,190:375,191:376,
      191:377,191:378,192:379,192:380,192:381,193:382,193:383,193:384,
      193:385,194:386,194:387,194:388,195:389,195:390,195:391,196:392,
      196:393,196:394,196:395,197:396,197:397,197:398,198:399,198:400,
      198:401,199:402,199:403,199:404,199:405,200:406,200:407,200:408,
      201:409,201:410,201:411,202:412,202:413,202:414,202:415,203:416,
      203:417,203:418,204:419,204:420,204:421,205:422,205:423,205:424,
      206:425,206:426,206:427,206:428,207:429,207:430,207:431,208:432,
      208:433,208:434,209:435,209:436,209:437,209:438,210:439,210:440,
      210:441,211:442,211:443,211:444,212:445,212:446,212:447,212:448,
      213:449,213:450,213:451,214:452,214:453,214:454,215:455,215:456,
      215:457,215:458,216:459,216:460,216:461,217:462,217:463,217:464,
      218:465,218:466,218:467,218:468,219:469,219:470,219:471,220:472,
      220:473,220:474,221:475,221:476,221:477,221:478,222:479,222:480,
      222:481,223:482,223:483,223:484,224:485,224:486,224:487,224:488,
      225:489,225:490,225:491,226:492,226:493,226:494,227:495,227:496,
      227:497,227:498,228:499,228:500,228:501,229:502,229:503,229:504,
      230:505,230:506,230:507,230:508,231:509,231:510,231:511,232:512,
      232:513,232:514,233:515,233:516,233:517,233:518,234:519,234:520,
      234:521,235:522,235:523,235:524,236:525,236:526,236:527,237:528,
      237:529,237:530,237:531,238:532,238:533,238:534,239:535,239:536,
      239:537,240:538,240:539,240:540,240:541,241:542,241:543,241:544,
      242:545,242:546,242:547,243:548,243:549,243:550,243:551,244:552,
      244:553,244:554,245:555,245:556,245:557,246:558,246:559,246:560,
      246:561,247:562,247:563,247:564,248:565,248:566,248:567,249:568,
      249:569,249:570,249:571,250:572,250:573,250:574,251:575,251:576,
      251:577,252:578,252:579,252:580,252:581,253:582,253:583,253:584,
      254:585,254:586,254:587,255:588,255:589,255:590,255:591,256:592,
      256:593,256:594,257:595,257:596,257:597,258:598,258:599,258:600,
      258:601,259:602,259:603,259:604,260:605,260:606,260:607,261:608,
      261:609,261:610,261:611,262:612,262:613,262:614,263:615,263:616,
      263:617,264:618,264:619,264:620,265:621,265:622,265:623,265:624,
      266:625,266:626,266:627,267:628,267:629,267:630,268:631,268:632,
      268:633,268:634,269:635,269:636,269:637,270:638,270:639,270:640,
      271:641,271:642,271:643,271:644,272:645,272:646,272:647,273:648,
      273:649,273:650,274:651,274:652,274:653,274:654,275:655,275:656,
      275:657,276:658,276:659,276:660,277:661,277:662,277:663,277:664,
      278:665,278:666,278:667,279:668,279:669,279:670,280:671,280:672,
      280:673,280:674,281:675,281:676,281:677,282:678,282:679,282:680,
      283:681,283:682,283:683,283:684,284:685,284:686,284:687,285:688,
      285:689,285:690,286:691,286:692,286:693,286:694,287:695,287:696,
      287:697,288:698,288:699,288:700,289:701,289:702,289:703,289:704,
      290:705,290:706,290:707,291:708,291:709,291:710,292:711,292:712,
      292:713,292:714,293:715,293:716,293:717,294:718,294:719,294:720,
      295:721,295:722,295:723,296:724,296:725,296:726,296:727,297:728,
      297:729,297:730,298:731,298:732,298:733,299:734,299:735,299:736,
      299:737,300:738,300:739,300:740,301:741,301:742,301:743,302:744,
      302:745,302:746,302:747,303:748,303:749,303:750,304:751,304:752,
      304:753,305:754,305:755,305:756,305:757,306:758,306:759,306:760,
      307:761,307:762,307:763,308:764,308:765,308:766,308:767,309:768,
      309:769,309:770,310:771,310:772,310:773,311:774,311:775,311:776,
      311:777,312:778,312:779,312:780,313:781,313:782,313:783,314:784,
      314:785,314:786,314:787,315:788,315:789,315:790,316:791,316:792,
      316:793,317:794,317:795,317:796,317:797,318:798,318:799,318:800,
      319:801,319:802,319:803,320:804,320:805,320:806,320:807,321:808,
      321:809,321:810,322:811,322:812,322:813,323:814,323:815,323:816,
      324:817,324:818,324:819,324:820,325:821,325:822,325:823,326:824,
      326:825,326:826,327:827,327:828,327:829,327:830,328:831,328:832,
      328:833,329:834,329:835,329:836,330:837,330:838,330:839,330:840,
      331:841,331:842,331:843,332:844,332:845,332:846,333:847,333:848,
      333:849,333:850,334:851,334:852,334:853,335:854,335:855,335:856,
      336:857,336:858,336:859,336:860,337:861,337:862,337:863,338:864,
      338:865,338:866,339:867,339:868,339:869,339:870,340:871,340:872,
      340:873,341:874,341:875,341:876,342:877,342:878,342:879,342:880,
      343:881,343:882,343:883,344:884,344:885,344:886,345:887,345:888,
      345:889,345:890,346:891,346:892,346:893,347:894,347:895,347:896,
      348:897,348:898,348:899,348:900,349:901,349:902,349:903,350:904,
      350:905,350:906,351:907,351:908,351:909,352:910,352:911,352:912,
      352:913,353:914,353:915,353:916,354:917,354:918,354:919,355:920,
      355:921,355:922,355:923,356:924,356:925,356:926,357:927,357:928,
      357:929,358:930,358:931,358:932,358:933,359:934,359:935,359:936,
      360:937,360:938,360:939,361:940,361:941,361:942,361:943,362:944,
      362:945,362:946,363:947,363:948,363:949,364:950,364:951,364:952,
      364:953,365:954,365:955,365:956,366:957,366:958,366:959,367:960,
      367:961,367:962,367:963,368:964,368:965,368:966,369:967,369:968,
      369:969,370:970,370:971,370:972,370:973,371:974,371:975,371:976,
      372:977,372:978,372:979,373:980,373:981,373:982,373:983,374:984,
      374:985,374:986,375:987,375:988,375:989,376:990,376:991,376:992,
      376:993,377:994,377:995,377:996,378:997,378:998,378:999,379:1000,
      379:1001,379:1002,379:1003,380:1004,380:1005,380:1006,381:1007,
      381:1008,381:1009,382:1010,382:1011,382:1012,383:1013,383:1014,
      383:1015,383:1016,384:1017,384:1018,384:1019,385:1020,385:1021,
      385:1022,386:1023,386:1024};

    function chartify(arr) {
        var gapcoingaps = arr.filter(function(a){return a[5] === "Gapcoin"});
        var sorted_gaps = gapcoingaps.sort(function(a, b) {return a[8] > b[8]});
        var row;
        var xdata = new Array;
        var ydata = new Array;
        var zdata = new Array;
        for (row of sorted_gaps.entries()) {
          ydata.push(row[1][0]);
          xdata.push(primedigits[row[1][8]]);
          zdata.push(Math.round(row[1][7]));
        }
        var margin = {top: 20, right: 15, bottom: 60, left: 80}, width = 960 - margin.left - margin.right, height = 500 - margin.top - margin.bottom;

      {% if page.xscale %}

        {% if page.xscale == 'scalePow' %}
        console.log("Setting x scale as Pow");
        var x = d3.scalePow()
                  .exponent(1.4)  // the range of the values to plot
                  .range([ 0, width ]);        // the pixel range of the x-axis
        {% elsif page.xscale == 'scaleLog' %}
        console.log("Setting x scale as Log");
        var x = d3.scaleLog()
                  .domain([1, d3.max(xdata)])  // the range of the values to plot
                  .range([ 1, width ]);        // the pixel range of the x-axis
        {% else %}
        console.log("Setting x scale as Linear");
        var x = d3.scaleLinear()
                  .domain([1, d3.max(xdata)])  // the range of the values to plot
                  .range([ 1, width ]);        // the pixel range of the x-axis
        {% endif %}
      {% endif %}

      {% if page.yscale and page.yscale == 'scalePow' %}
        console.log("Setting y scale as Pow");
        var y = d3.scalePow()
                  .exponent(1.4)
                  .range([ height, 0 ]);
      {% elsif page.yscale == 'scaleLog' %}
        console.log("Setting y scale as Log");
        var y = d3.scaleLog()
                  .domain([1, d3.max(ydata)])  // the range of the values to plot
                  .range([ height, 0 ]);
      {% else %}
        console.log("Setting y scale as Linear");
        var y = d3.scaleLinear()
                  .domain([1, d3.max(ydata)])  // the range of the values to plot
                  .range([ height, 1 ]);        // the pixel range of the x-axis
      {% endif %}

        // the chart object, includes all margins
        var chart = d3.select('#content')
          .append('svg:svg')
          .attr('width', width + margin.right + margin.left)
          .attr('height', height + margin.top + margin.bottom)
          .attr('class', 'chart')

        // the main object where the chart and axis will be drawn
        var main = chart.append('g')
          .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')
          .attr('width', width)
          .attr('height', height)
          .attr('class', 'main')   

        // draw the x axis
        var xAxis = d3.axisBottom()
          .scale(x);
          //.orient('bottom');

        main.append('g')
          .attr('transform', 'translate(0,' + height + ')')
          .attr('class', 'main axis date')
          .call(xAxis);

        // draw the y axis
        var yAxis = d3.axisLeft()
          .scale(y)
          axisLabel: 'Label here';
          // .orient('left');

        main.append('g')
          .attr('transform', 'translate(0,0)')
          .attr('class', 'main axis date')
          .call(yAxis);

        // draw the graph object
        var g = main.append("svg:g"); 

        g.selectAll("scatter-dots")
          .data(ydata)  // using the values in the ydata array
          .enter().append("svg:circle")  // create a new circle for each value
              .attr("cy", function (d) { return y(d); } ) // translate y value to a pixel
              .attr("cx", function (d,i) { return x(xdata[i]); } ) // translate x value
              .attr("r", 2) // radius of circle
              .style("fill", function (d,i) { return d3.interpolateRdYlGn((zdata[i] - d3.min(zdata)) / (d3.max(zdata) - d3.min(zdata))); });

        main.append("text")
          .attr("fill", "#888")
          .attr("text-anchor", "end")
          .attr("x", width)
          .attr("y", height + margin.top + 20)
          .text("Shift");

        main.append("text")
          .attr("fill", "#888")
          .attr("text-anchor", "end")
          .attr("transform", "rotate(-90)")
          .attr("y", -margin.left+25)
          .attr("x", -margin.top)
          .text("Gap size");
    };

    function parsegapentry(val, index) {
      if (index == 0)
          return parseInt(val, 10);
      else if (index == 1)
        if (val == '1')
          return true;
        else
          return false;
      else if (index > 3 && index < 5)
        return val
      else if (index == 6)
        return parseInt(val, 10)
      else if (index == 7)
        return parseFloat(val, 10)
      else if (index == 8)
        return parseInt(val, 10)
      else
        return val;
    };

    $('.page.dimmer:first')
      .dimmer('toggle');

    $(document).ready(function() {
      $('.ui.dimmer').dimmer('show');
      // Uncomment to refresh
      // $.when(
      //     $.get("https://raw.githubusercontent.com/primegap-list-project/primegap-list-project.github.io/master/_data/allgaps.csv")
      // ).then(function(gapscsv) {
      //   gapsarray = $.csv.toArrays(gapscsv);
      //   var gapsentries = gapsarray.map(function(entry) {
      //       return entry.map(parsegapentry)
      //   });
      //   chartify(gapsentries);
      //   return;
      // });
      $('.ui.dimmer').dimmer('hide');
    });
    </script>
  </body>
</html>
